---
title: Plugin iOSCloud
description: Localisation iCloud, gestion de pr√©sence et actions sur vos appareils Apple.
---

import PluginHero from '@site/src/components/PluginHero';


<PluginHero
  title="Plugin iOSCloud"
  description="Localisation iCloud, gestion de pr√©sence et actions sur vos appareils Apple."
  icon="/img/plugins/ioscloud_icon.png"
  badges={["Jeedom 4.4+", "beta", "os 11+", "php 7.4/8.x","python"]}
  donateUrl="https://www.paypal.me/Zyg0m4t1k"
/>

Ce document d√©crit le plugin **iOSCloud** : configuration, authentification, √©quipements, pr√©sence et sc√©narios.

**Acc√®s rapide :**

- [Pr√©sentation](#pr√©sentation)
- [Pr√©requis](#pr√©requis)
- [Installation](#installation)
- [Proc√©dure d‚Äôauthentification](#proc√©dure-compl√®te-dauthentification-important)
- [Types d‚Äô√©quipements](#types-d√©quipements)
- [Param√®tres importants](#param√®tres-importants)
- [Utilisation en sc√©nario](#utilisation-en-sc√©nario)
- [Conseils pratiques](#conseils-pratiques)

---

# Pr√©sentation

Le plugin **iOSCloud** permet √† Jeedom de se connecter √† votre compte **iCloud** afin de :

- r√©cup√©rer la **localisation** de vos appareils Apple (iPhone, iPad‚Ä¶)
- calculer automatiquement une **pr√©sence** (√† la maison / absent)
- d√©clencher des actions comme **faire sonner un appareil** ou **envoyer un message**

> Objectif : automatiser simplement votre pr√©sence et vos appareils Apple dans Jeedom.

<!-- SCREEN √Ä AJOUTER : vue d‚Äôensemble du plugin -->

---

# Pr√©requis

## Configuration minimum

- Jeedom **4.4 minimum**
- Debian **10 minimum** (Debian 11 recommand√©)
- PHP **7.4 minimum**
- Un compte **Apple iCloud**
- Un appareil Apple de confiance (pour recevoir le code de s√©curit√©)

---

# Installation

## 1Ô∏è‚É£ Installer le plugin

1. Jeedom ‚Üí **Plugins**
2. **Market**
3. Rechercher **iOSCloud**
4. Installer puis activer

<!-- SCREEN √Ä AJOUTER : installation Market -->

---

## 2Ô∏è‚É£ Installer les d√©pendances

Dans la page du plugin :

Cliquez sur **(R√©)installer les d√©pendances**

Le plugin utilise un module Python interne pour dialoguer avec iCloud.  
Jeedom installe automatiquement ce qu‚Äôil faut.

Attendez que l‚Äô√©tat passe √† **OK**.

<!-- SCREEN √Ä AJOUTER : d√©pendances OK -->

---

# Proc√©dure compl√®te d‚Äôauthentification (IMPORTANT)

La connexion √† iCloud n√©cessite une **double authentification (2FA)**.

Apple envoie un **code de s√©curit√© temporaire** sur vos appareils Apple.

---

## √âtape 1 ‚Äî Configurer le compte iCloud

Cr√©er un √©quipement de type **Compte iCloud (cloud)**.

Dans sa configuration :

- Adresse iCloud (email Apple)
- Mot de passe iCloud

Sauvegarder.

---

## √âtape 2 ‚Äî Lancer l‚Äôauthentification

Dans l‚Äô√©quipement :

Cliquer sur **Authentification**

Le plugin tente la connexion.

---

## √âtape 3 ‚Äî R√©ception du code Apple

Si Apple demande un code :

- Vous recevez un code sur votre iPhone / iPad
- Un champ "code" appara√Æt dans le plugin

Entrer le code re√ßu.

Cliquer sur **Envoyer code**

---

## √âtape 4 ‚Äî Validation

Le plugin affiche la progression :

- Connexion
- Code demand√©
- Code envoy√©
- Code valid√©
- Synchronisation des appareils

Quand la validation est termin√©e :

‚úÖ Les appareils sont r√©cup√©r√©s automatiquement  
‚úÖ Les √©quipements "devices" sont cr√©√©s ou mis √† jour

---

## Cas normaux (ne pas s‚Äôinqui√©ter)

- Apple peut redemander un code apr√®s quelques jours
- Si le code expire ‚Üí recommencer
- Si mot de passe incorrect ‚Üí connexion refus√©e

> √âviter de lancer l‚Äôauthentification trop souvent.

<!-- SCREEN √Ä AJOUTER : √©cran authentification + champ code -->

---

# Types d‚Äô√©quipements

Le plugin cr√©e plusieurs types d‚Äô√©quipements :

---

## ‚òÅÔ∏è Compte iCloud (cloud)

√âquipement principal.

Contient :

- Identifiants iCloud
- Bouton Authentification
- Gestion du rafra√Æchissement
- Param√®tres cron

---

## üì± Appareil iCloud (devices)

Un √©quipement par appareil Apple.

Commandes disponibles :

- Localisation
- Batterie
- Timestamp
- State
- Play sound
- Message

<!-- SCREEN √Ä AJOUTER : page √©quipement device -->

---

## üìç Position fixe (fixed)

Permet de d√©finir un point GPS manuel (ex : Maison).

Format obligatoire :

latitude,longitude

Exemple :

46.2044,6.1432

---

## üìè Distance / Pr√©sence (geofence_dist)

Calcule :

- Distance entre un point fixe et un appareil
- Pr√©sence (0 ou 1) selon un rayon d√©fini

Param√®tres :

- Position de r√©f√©rence
- Rayon (ex : 300 m√®tres)
- Appareils surveill√©s

<!-- SCREEN √Ä AJOUTER : configuration geofence -->

---

# Param√®tres importants

## Rafra√Æchissement

Ne pas mettre une fr√©quence trop courte.  
Recommand√© : toutes les 5 minutes.

---

## D√©lai √©tat

Temps avant que l‚Äô√©tat repasse √† 0 si aucune mise √† jour.  
D√©faut : 1 heure.

---

## Rayon de pr√©sence

- 100 m ‚Üí tr√®s strict
- 300 m ‚Üí bon compromis
- 500 m ‚Üí plus stable

---

# Utilisation en sc√©nario

## Exemple ‚Äî Retour √† la maison

Condition :

`#[iOSCloud][Maison - Pr√©sence][Presence]# == 1`

Actions possibles :

- Allumer lumi√®res
- D√©sactiver alarme
- Envoyer notification

---

## Exemple ‚Äî D√©part

`#[iOSCloud][Maison - Pr√©sence][Presence]# == 0`

---

## Faire sonner un iPhone

`#[iOSCloud][iPhone][Play sound]#`

---

## Envoyer un message

`#[iOSCloud][iPhone][Message]#`

---

# Conseils pratiques

1. Ne pas rafra√Æchir trop souvent
2. Ajuster le rayon si la pr√©sence varie trop
3. Relancer l‚Äôauthentification si Apple redemande un code
4. Pour √©viter les faux d√©parts, cr√©er un sc√©nario :
   - Presence = 0
   - Depuis plus de X minutes
   ‚Üí Activer mode absent

---
